# Pararell FCM

## 異なる初期温度を各スレッドに割り当てる方法

### 実験方法
通常のFCMを複数のスレッドで並列に実行。

![temperature](pararell1.png)
<center>図1 各スレッドの動作</center>


### 結果
最高温度T_max=20, スレッド数N=128, 超高速アニーリング, q=2.0固定, 0-Tmax温度設定法, irisで実験した結果を下記に示す。 
初期温度4.0以上ではクラスタリングに失敗したため省略。

```
[スレッド番号] T=[初期温度][2回目の温度]... 誤分類数
[0] T=0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.01  e=14
[1] T=0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.01  e=14
[2] T=0.06 0.06 0.06 0.06 0.06 0.06 0.06 0.06 0.06 0.06 0.06 0.01  e=16
[3] T=0.06 0.06 0.06 0.06 0.06 0.06 0.06 0.01  e=15
[4] T=0.06 0.06 0.06 0.06 0.06 0.06 0.06 0.01  e=15
                                     ：
[84] T=2.67 2.67 2.67 2.67 2.67 2.67 2.67 2.67 2.67 2.67 2.67 2.67 2.67 0.36 0.36 0.36 0.36 0.36 0.36 0.25  e=15
[85] T=2.80 2.80 2.80 2.80 2.80 2.80 2.80 2.80 2.80 0.38 0.38 0.38 0.38 0.38 0.38 0.38 0.26  e=15
[86] T=2.93 2.93 2.93 2.93 2.93 2.93 0.40 0.40 0.40 0.40 0.40 0.40 0.40 0.40 0.27 0.27 0.21  e=16
[87] T=3.08 3.08 3.08 3.08 3.08 3.08 3.08 3.08 3.08 3.08 0.42 0.42 0.42 0.42 0.42 0.42 0.42 0.29  e=15
```
最小値14であり、これはThighを変化させながらCPUでクラスタリングを行ったのと同じ結果である。
各スレッドが独立した動作を行っているため、当然といえば当然であるが。


### 考察
結果がCPUと変わらないので、その時点における最良解を各スレッドに再度割り当てる方法を考える。  
ここで問題となるのは
* 最良解の選択方法と評価関数の作成方法。
* 貪欲法になるため、最適解が得られる保証がない。
* 温度の下げ方。


![temperature](pararell2.png)
<center>図2 状態交換</center>


## 0-Tmax温度設定法
0~Thighとなるように各スレッドに温度を割りあてる。
均等に割り当てるため、n乗項を利用する。  
スレッド数をn, 各スレッド番号をi(-64<i<64)とし、各スレッドに対応した温度を$T_i$、最高温度$T_{max}$は

```math
T_i = T_{max}^{1/n}
```
で求められる。
横軸をi, 縦軸を温度$T_i$としたときのグラフを図3に示す。このとき、n=128, T_{max}=20とした。


![temperature](temperature.png)
<center>図3 スレッド数128、最高温度20としたときの各スレッドに割り当てられる初期温度</center>





